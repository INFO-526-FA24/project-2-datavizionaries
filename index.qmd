---
title: "MindScope: Unveiling Patterns in Mental Health through Data-Driven Insights"
subtitle: ""
author: 
  - name: "Team Data Vizionaries"
    affiliations:
      - name: "College of Information Science, University of Arizona"
description: "Project 2 for INFO 526 course instructed by Prof. Anna Leach"
format:
  html:
    code-tools: true
    code-overflow: wrap
    code-line-numbers: false
    embed-resources: true
editor: visual
code-annotations: hover
execute:
  warning: false
---

## Abstract

## Dataset Introduction

## Question 1: 

### Part 1 : What correlations exist between coping difficulties, social weakness, and work interest in occupation and self-employment status?

## Approach:

## Analysis:

```{r}
# List of required packages
required_packages <- c("tidyverse", "skimr", "readr", "dplyr", "countrycode", "patchwork", 
                       "ggplot2", "ggiraph", "sf", "gganimate", "gridExtra","transformr","corrplot","tidyr","reshape2")

# Function to check if a package is installed; if not, install it
install_if_missing <- function(pkg) {
  if (!requireNamespace(pkg, quietly = TRUE)) {
    message(paste("Installing package:", pkg))
    install.packages(pkg, dependencies = TRUE)
  } else {
    message(paste("Package", pkg, "is already installed"))
  }
}

# Apply the function to each package
invisible(lapply(required_packages, install_if_missing))

# Function to load all the required packages
load_packages <- function(pkg_list) {
  invisible(lapply(pkg_list, function(pkg) {
    library(pkg, character.only = TRUE)
  }))
}

load_packages(required_packages)
```

```{r}

# Load required libraries
library(dplyr)
library(readr)
library(ggplot2)
library(reshape2)
library(viridis)

# Read the data
df <- read_csv("./data/mental_health.csv")

# Convert column names to lowercase and replace spaces with underscores
names(df) <- tolower(names(df))
names(df) <- gsub(" ","_", names(df))

# Create a smaller dataframe with just the four variables of interest
df_selected <- data.frame(
  coping_struggles = ifelse(df$coping_struggles == "Yes", 1, 0),
  social_weakness = case_when(
    df$social_weakness == "Yes" ~ 2,
    df$social_weakness == "Maybe" ~ 1,
    df$social_weakness == "No" ~ 0
  ),
  work_interest = ifelse(df$work_interest == "Yes", 1, 0),
  self_employed = ifelse(df$self_employed == "Yes", 1, 0)
)

# Calculate correlation matrix
cor_matrix <- cor(df_selected, use = "complete.obs")

# Melt the correlation matrix for ggplot
cor_melted <- reshape2::melt(cor_matrix)

# Create correlation plot
cor_plot <- ggplot(cor_melted, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile() +
  geom_text(aes(label = sprintf("%.2f", value)), 
            #color = ifelse(abs(cor_melted$value) > 0.5, "white", "black"), 
            size = 4) +
  scale_fill_viridis(
    option = "viridis",
    limits = c(-1, 1),
    name = "Correlation"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
    axis.text.y = element_text(size = 10),
    axis.title = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    panel.background = element_blank(),
    plot.title = element_text(hjust = 0.5, size = 14)
  ) +
  ggtitle("Correlation Matrix of Mental Health Factors") +
  coord_fixed()

# Display the plot
print(cor_plot)

# Save the plot
ggsave("./images/selected_correlations.png", cor_plot, 
       width = 8, height = 6, dpi = 500)
```
