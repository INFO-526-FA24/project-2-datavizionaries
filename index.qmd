---
title: "MindScope: Unveiling Patterns in Mental Health through Data-Driven Insights"
subtitle: ""
author: 
  - name: "Team Data Vizionaries"
    affiliations:
      - name: "College of Information Science, University of Arizona"
description: "Project 2 for INFO 526 course instructed by Prof. Anna Leach"
format:
  html:
    code-tools: true
    code-overflow: wrap
    code-line-numbers: false
    embed-resources: true
editor: visual
code-annotations: hover
execute:
  warning: false
---

## Abstract

## Dataset Introduction

## Question 1:

### Part 1 : What correlations exist between coping difficulties, social weakness, and work interest in occupation and self-employment status?

## Approach:

## Analysis:

```{r}
# List of required packages
required_packages <- c("tidyverse", "skimr", "readr", "dplyr", "countrycode", "patchwork", 
                       "ggplot2", "ggiraph", "sf", "gganimate", "gridExtra","transformr","corrplot","tidyr","reshape2")

# Function to check if a package is installed; if not, install it
install_if_missing <- function(pkg) {
  if (!requireNamespace(pkg, quietly = TRUE)) {
    message(paste("Installing package:", pkg))
    install.packages(pkg, dependencies = TRUE)
  } else {
    message(paste("Package", pkg, "is already installed"))
  }
}

# Apply the function to each package
invisible(lapply(required_packages, install_if_missing))

# Function to load all the required packages
load_packages <- function(pkg_list) {
  invisible(lapply(pkg_list, function(pkg) {
    library(pkg, character.only = TRUE)
  }))
}

load_packages(required_packages)
```

```{r}

# Load required libraries
library(dplyr)
library(readr)
library(ggplot2)
library(reshape2)
library(viridis)

# Read the data
df <- read_csv("./data/mental_health.csv")

# Convert column names to lowercase and replace spaces with underscores
names(df) <- tolower(names(df))
names(df) <- gsub(" ","_", names(df))

# Create a smaller dataframe with just the four variables of interest
df_selected <- data.frame(
  coping_struggles = ifelse(df$coping_struggles == "Yes", 1, 0),
  social_weakness = case_when(
    df$social_weakness == "Yes" ~ 2,
    df$social_weakness == "Maybe" ~ 1,
    df$social_weakness == "No" ~ 0
  ),
  work_interest = ifelse(df$work_interest == "Yes", 1, 0),
  self_employed = ifelse(df$self_employed == "Yes", 1, 0)
)

# Calculate correlation matrix
cor_matrix <- cor(df_selected, use = "complete.obs")

# Melt the correlation matrix for ggplot
cor_melted <- reshape2::melt(cor_matrix)

# Keep only upper triangle of the correlation matrix  
cor_melted <- cor_melted[which(as.integer(cor_melted$Var1) <= as.integer(cor_melted$Var2)), ]  

# Create correlation plot
cor_plot <- ggplot(cor_melted, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile() +
  geom_text(aes(label = sprintf("%.2f", value)), 
            #color = ifelse(abs(cor_melted$value) > 0.5, "white", "black"), 
            size = 4) +
  # scale_fill_viridis(
  #   option = "viridis",
  #   limits = c(-1, 1),
  #   name = "Correlation"
  # ) +
  scale_fill_gradient(low = "#c8ac7d", high = "#555ba5")+
  theme_minimal() +
  theme(
    #axis.text.x = element_text(hjust = 1, size = 10, angle=90),
    axis.text.x = element_blank(),
    axis.text.y = element_text(size = 10),
    axis.title = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    panel.background = element_blank(),
    plot.title = element_text(hjust = 0.5, size = 14),
    legend.title = element_blank(),
  ) +
  ggtitle("Correlation Matrix of Mental Health Factors") +
  coord_fixed()

# Display the plot
print(cor_plot)

# Save the plot
ggsave("./images/new_selected_correlations.png", cor_plot, 
       width = 8, height = 6, dpi = 500)
```

<p style="text-align:justify">

The image shows a correlation matrix heatmap between the four mental-health related variables: coping_struggles, social_weakness, work_interest and self_employed. The matrix uses a color schema ranging from yellow(1.0) to teal(0). Looking at the specific correlations, we can observe that each variable has perfect positive correlation(1.00) with itself, shown in yellow along the diagonal. However, the relationship between different variables is significantly weak or non-existent with values very close to zero. For instance, work_interest and social_weakness show a very slight negative correlation of -0.05, while coping_struggles and social_weakness have a minimal positive correlation of 0.01. The variable self-employed shows no correlation with any other factors. These observations indicate that these mental health factors are independent of each other.

</p>
